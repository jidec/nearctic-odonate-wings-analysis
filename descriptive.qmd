---
title: "Descriptive"
---

Load packages for exploratory data visualization

```{r, message=FALSE, warning=FALSE}

library(DataExplorer)
library(GGally)
library(colorEvoHelpers)
library(dplyr)

# prep isn't tested currently, so load in data already created for now
#wings <- read.csv("data/wings.csv")
wings <- read.csv("data/wings_new.csv")
wings$blackbrown <- wings$black
wings$brownyellow <- wings$brown
wings$sex <- wings$Sex
wings$wing_length <- wings$Length..outer..FW..mm.
wings$temperature <- wings$temp_indv
wings$flight_type <- wings$flight_type_rm_inter
wings$is_damselfly <- wings$Suborder == "Zygoptera"

wings <- select(wings, blackbrown, brownyellow, 
                wing_length, flight_type, sex,
                lat, lon, temp_indv,
                species, is_damselfly,
                wing_type) 

write.csv(wings,"wings_for_mike.csv")

```

What colors have come out of our clustering?

```{r}

row <- wings[1,]
# three are notably darker, and looking at images correspond to visibly pigmented areas
plotRGB(c(row$col_1_r,row$col_1_g,row$col_1_b),max=1)
plotRGB(c(row$col_2_r,row$col_2_g,row$col_2_b),max=1)
plotRGB(c(row$col_6_r,row$col_6_g,row$col_6_b),max=1)
# other 3 are different shades of white and tan, shades of unpigmented wings
plotRGB(c(row$col_3_r,row$col_3_g,row$col_3_b),max=1)
plotRGB(c(row$col_4_r,row$col_4_g,row$col_4_b),max=1)
plotRGB(c(row$col_5_r,row$col_5_g,row$col_5_b),max=1)
```

Visualize the distribution of the Odonate percher-flyer dichotomy (flight_type) and sex in the dataset

```{r}

plot_bar(select(wings, flight_type, sex))
```

1.  Many more perchers than flyers
2.  More males than females

Visualize distributions of continuous predictors and responses

```{r}

plot_density(select(wings,blackbrown,brownyellow,temp_indv,wing_length)) #temp_indv,lat,lon,mean_lightness))
```

Visualize correlations between pertinent variables

```{r}

plot_correlation(select(wings,black,brown,yellow,temp_indv,Length..inner..FW..mm.,flight_type, Sex))


```

```{r}

sp <- wings %>% group_by(species) %>% summarize(blackbrown = mean(black),brownyellow = mean(brown))

nrow(dplyr::filter(sp, blackbrown > 0.05)) / nrow(sp)
nrow(dplyr::filter(sp, brownyellow > 0.05)) / nrow(sp)
```

Plot densities of blackbrown and brownyellow

```{r}

ggplot(data=wings, aes(x = black)) +
  geom_density(fill = "blue", color = "black", alpha = 0.5) +
  xlab("Variable Name") +
  ylab("Density") +
  ggtitle("Density Plot of Continuous Variable")

ggplot(data=sp, aes(x = blackbrown)) +
  geom_density(fill = "blue", color = "black", alpha = 0.5) +
  xlab("Variable Name") +
  ylab("Density") +
  ggtitle("Density Plot of Continuous Variable")

```

Review hist of collections

```{r}

barplot(table(as.factor(wings$Collection)))

nrow(filter(wings,Collection == "RUN")) / nrow(wings)

```

What collections are specimens from?

```{r}

library(dplyr)
supp <- wings %>%
  select(Collection,Collection.Unique.ID) %>%
  distinct(Collection.Unique.ID, .keep_all = TRUE)

View(supp)

table(supp$Collection)

supp$Col <- supp$Collection

supp$Col[supp$Collection == "UA"] <- "Alabama Museum of Natural History"
supp$Col[supp$Collection == "MLM"] <- "Collection of Michael L. May"
supp$Col[supp$Collection == "RUN"] <- "Rutgers-University Newark (Now Housed at AMNH)"
supp$Col[supp$Collection == "WRK-WS"] <- "Collection of William Kuhn (Now Housed at AMNH)"

colnames(supp) <- c("collection_code","collection_unique_id", "collection_name")
```
